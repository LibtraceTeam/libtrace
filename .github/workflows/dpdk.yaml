name: DPDK Build
on:
  push:
    paths:
    - 'configure.in'
    - 'lib/format_dpdk.c'
    - 'lib/format_dpdk.h'
    - 'lib/dpdk_libtrace.mk'
    - 'lib/format_dpdkndag.c'
  pull_request:
    paths:
    - 'configure.in'
    - 'lib/format_dpdk.c'
    - 'lib/format_dpdk.h'
    - 'lib/dpdk_libtrace.mk'
    - 'lib/format_dpdkndag.c'
jobs:
  build-dpdk:
    name: Build DPDK
    runs-on: ubuntu-20.04
    steps:
    - uses: actions/checkout@v2
      with:
        path: libtrace
        submodules: recursive
    - name: Install Dependencies
      run: sudo apt-get -y install meson flex bison libpcap0.8-dev libtool pkgconf wget m4 autoconf automake gcc
    - name: Build DPDK
      run: cd libtrace/test; sudo ./do-test-build-dpdk.sh
